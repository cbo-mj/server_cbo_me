function setUpForm(e, t) { function a(e, t, n) { var r = e.indexOf("]") + 2; var i = "<label>" + e.substring(r) + "</label>"; var o = '<input type="text" class="form-control" id="' + t + '" value="' + n + '">'; var u = '<div class="form-group">' + i + o + "</div>"; s += u } function f(e, t, n) { var r = e.indexOf("]") + 2; var i = "<label>" + e.substring(r) + "</label>"; var o = '<textarea rows="3" class="form-control" id="' + t + '" value="' + n + '"></textarea>'; var u = '<div class="form-group">' + i + o + "</div>"; s += u } function l(e, t, n) { var r = ""; var i = ""; var o = e.indexOf("]") + 2; for (var u = 0; u < t.listItems.length; u++) { if (n == t.listItems[u]) i = "checked"; else i = ""; var a = '<label><input type="radio" name="id-' + t.id + '" id="id-' + t.id + "-" + u + '" value="' + t.listItems[u] + '" ' + i + " >" + t.listItems[u] + "</label>"; r += '<div class="radio">' + a + "</div>" } s += "<div class='form-group'><label>" + e.substring(o) + "</label>" + r + "</div>" } var n = e; var r = "https://completebusinessonline.worldsecuresystems.com"; var i = parent.$.cookie("siteAuthToken"); $(".container").removeClass("hide"); var s = ""; var o = []; var u = $.ajax({ url: r + "/api/v2/admin/sites/current/webapps/Solutions Configuration Settings/items", cache: false, type: "GET", headers: { Authorization: i }, contentType: "application/json" }); u.error(function (e) { $("#settings-browser").show() }); u.done(function (e) { var u = e.items[0].id; var c = $.ajax({ url: r + "/api/v2/admin/sites/current/webapps/Solutions Configuration Settings/items/" + u, cache: false, type: "GET", headers: { Authorization: i }, contentType: "application/json" }); c.done(function (e) { var c = e.fields; var h = e.description; var p = $.ajax({ url: r + "/api/v2/admin/sites/current/webapps/Solutions Configuration Settings/fields", cache: false, type: "GET", headers: { Authorization: i }, contentType: "application/json" }); p.done(function (e) { var h = []; var p = []; var d = []; var v = []; var m = 0; for (var g = 0; g < e.totalItemsCount; g++) { v[g] = e.items[g].name; if (v[g].indexOf(n) >= 0 || v[g].indexOf(t) >= 0) { p[m] = v[g]; h[m] = c[p[m]]; d[m] = e.items[g].type; o[m] = "id-" + e.items[m].id; if (d[m] == "String" || d[m] == "Image") a(p[m], o[m], h[m]); else if (d[m] == "String_MultiLine") f(p[m], o[m], h[m]); else if (d[m] == "Radio_List") l(p[m], e.items[g], h[m]); m++ } } $("#settings-form").html(s + '<div id="settings-success" class="alert alert-success" style="display:none"><p>Your settings have been successfully submitted.</p></div><div id="settings-fail" class="alert alert-danger" style="display:none"><p>Your update has failed. Note: Some browsers are not supported.</p></div><div id="settings-unauthorized" class="alert alert-danger" style="display:none;"><p>Your login has expired. Please re-login and try again.</p></div><p><a class="btn btn-large btn-success" id="settings-button">Update My Settings</a></p>'); $("#settings-button").click(function () { var e = []; for (var t = 0; t < o.length; t++) { var n = "#" + o[t]; if (d[t] == "Radio_List") fieldValue = $("input[name=" + o[t] + "]:checked", "#settings-form").val(); else fieldValue = $(n).val(); e[t] = '"' + p[t] + '":"' + fieldValue + '"' } var s = '"fields":{' + e.join() + "}"; var a = $.ajax({ url: r + "/api/v2/admin/sites/current/webapps/Solutions Configuration Settings/items/" + u, type: "PUT", headers: { Authorization: i }, contentType: "application/json", processData: false, statusCode: { 200: function () { $(".alert").hide(); $("#settings-success").fadeIn("fast") }, 400: function () { $(".alert").hide(); $("#settings-fail").fadeIn("fast") }, 401: function () { $(".alert").hide(); $("#settings-unauthorized").fadeIn("fast") }, 403: function () { $(".alert").hide(); $("#settings-fail").fadeIn("fast") }, 404: function () { $(".alert").hide(); $("#settings-fail").fadeIn("fast") } }, data: "{ " + s + "}" }) }) }) }) }) }